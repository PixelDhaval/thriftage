import{K as T,r as a,j as e,L as v,a as A}from"./app-CBgNfxV6.js";import{D as k}from"./delete-confirmation-dialog-BJZ4sBDB.js";import{B as F,t as u}from"./index-CxkpNBdp.js";import{D as h,e as I,a as x,b as f,c as D,d as g}from"./dialog-BcVaU9Qh.js";import{A as L}from"./app-layout-DR9tcCOi.js";import M from"./CreatePermissionForm-BZGpcr5b.js";import _ from"./EditPermissionForm-CIbTMPqF.js";import{D as $}from"./data-table-CQechFEf.js";import{P as B}from"./plus-D7GxHvF9.js";import"./index-CBcOgFbC.js";import"./index-uXSY9LXb.js";import"./input-3IsToTN2.js";import"./label-DNWKkJcz.js";import"./progress-CFwJbafQ.js";import"./app-logo-icon-xi0eLu_D.js";import"./select-C2ax7mEg.js";import"./floating-ui.dom-C5vApqfE.js";import"./check-Dj-469CK.js";import"./index-uOd2QEXc.js";import"./chevrons-up-down-DfHQhOV1.js";import"./chevron-right-DR-G9Dqz.js";import"./CreateGradedBagPoolForm-B8eUe2q9.js";import"./async-select-D5o3p28K.js";import"./printGradedBarcodes-u0ulMplK.js";import"./printer-C-JYDqHW.js";import"./chevron-left-6Nt7LTEn.js";const K=[{title:"Permissions Management",href:"/permissions"}];function he({permissions:R}){const r=T().props.auth,o=(r==null?void 0:r.permissions)||[],[j,c]=a.useState(!1),[w,n]=a.useState(!1),[y,l]=a.useState(!1),[d,b]=a.useState(null),[i,m]=a.useState(null),P=s=>{m(s),l(!0)},C=async()=>{var s,t,p;if(i)try{await A.delete(`/permissions/${i.id}`,{headers:{"X-CSRF-TOKEN":((s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.getAttribute("content"))||"",Accept:"application/json"}}),u.success(`Permission ${i.name} deleted successfully.`),(t=window.refreshDataTable)==null||t.call(window)}catch(O){console.error("Error deleting permission:",O),u.error("Failed to delete permission. Please try again later.")}l(!1),m(null),(p=window.refreshDataTable)==null||p.call(window)},N=s=>{var t;b(s),n(!0),(t=window.refreshDataTable)==null||t.call(window)},S=[{label:"Name",key:"name"},{label:"Display Name",key:"display_name"}],E=[{id:"name",header:"Name",enableSorting:!0,cell:({row:s})=>e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{children:s.original.name})})},{id:"display_name",header:"Display Name",enableSorting:!0,cell:({row:s})=>e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{children:s.original.display_name})})}];return e.jsxs(L,{breadcrumbs:K,children:[e.jsx(v,{title:"Permissions Management"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4",children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Permissions Management"}),o.includes("permissions-update")&&e.jsxs(h,{open:j,onOpenChange:c,children:[e.jsx(I,{asChild:!0,children:e.jsxs(F,{children:[e.jsx(B,{className:"mr-2 h-4 w-4"}),"Add Permission"]})}),e.jsxs(x,{className:"max-h-[90vh] overflow-y-auto",children:[e.jsxs(f,{children:[e.jsx(D,{children:"Create New Permission"}),e.jsx(g,{children:"Add a new permission to the system."})]}),e.jsx(M,{onSuccess:()=>{var s;c(!1),(s=window.refreshDataTable)==null||s.call(window)}})]})]})]}),e.jsx($,{filterableColumns:S,route:"/api/permissions",columns:E,pageSize:20,...o.includes("permissions-update")&&{onEdit:N},...o.includes("permissions-update")&&{onDelete:P},params:{}})]}),e.jsx(h,{open:w,onOpenChange:n,children:e.jsxs(x,{className:"max-h-[90vh] overflow-y-auto",children:[e.jsxs(f,{children:[e.jsx(D,{children:"Edit Permission"}),e.jsx(g,{children:"Update permission details."})]}),d&&e.jsx(_,{permission:d,onSuccess:()=>{var s;n(!1),(s=window.refreshDataTable)==null||s.call(window)}})]})}),e.jsx(k,{isOpen:y,onClose:()=>{l(!1),m(null)},onConfirm:C,title:"Delete Permission",description:`Are you sure you want to delete ${i==null?void 0:i.name}? This action cannot be undone. Any users and roles with this permission will lose it.`})]})}export{he as default};
