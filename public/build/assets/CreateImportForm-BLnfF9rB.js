import{r as x,m as E,j as e,a as C}from"./app-D3RpFw1c.js";import{B as F,t as d}from"./index-j5gbDOSy.js";import{f as S}from"./dialog-Bqj4tW-w.js";import{I as n}from"./input-DJJBeymp.js";import{L as i}from"./label-BuewIT6O.js";import{S as B,a as D,b as I,c as L,d as _}from"./select-DYgrvj38.js";import{A as P}from"./async-select-BT_EDcVt.js";import"./index-84hm46iC.js";import"./floating-ui.react-dom-D3kokhNA.js";import"./floating-ui.dom-C5vApqfE.js";import"./check-ah26TeO-.js";function z({onSuccess:o}){const[u,c]=x.useState(!1),{data:a,setData:s,errors:r,setError:b,reset:j,clearErrors:v}=E({party_id:"",container_no:"",movement_date:"",bl_no:"",bl_date:"",be_no:"",be_date:"",bl_weight:"",weigh_bridge_weight:"",type:"container"}),[y,N]=x.useState(null),w=async t=>{var m,h;t.preventDefault(),v(),c(!0);try{const l=await C.post("/imports",a,{headers:{"X-CSRF-TOKEN":((m=document.querySelector('meta[name="csrf-token"]'))==null?void 0:m.getAttribute("content"))||"","Content-Type":"application/json",Accept:"application/json"}});d.success("Import created successfully!"),j(),o==null||o()}catch(l){if(console.error("Error creating import:",l),((h=l.response)==null?void 0:h.status)===422){const p=l.response.data.errors;Object.keys(p).forEach(g=>{b(g,p[g][0])}),d.error("Please check the form for errors.")}else d.error("Failed to create import. Please try again later.")}finally{c(!1)}},f=()=>a.type==="container"?{type:"importer"}:a.type==="local"?{type:"local"}:{};return e.jsxs("form",{onSubmit:w,className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(i,{htmlFor:"type",children:"Import Type"}),e.jsxs(B,{value:a.type,onValueChange:t=>s("type",t),children:[e.jsx(D,{children:e.jsx(I,{placeholder:"Select import type"})}),e.jsxs(L,{children:[e.jsx(_,{value:"container",children:"Via Container"}),e.jsx(_,{value:"local",children:"Local Delivery"})]})]}),r.type&&e.jsx("p",{className:"text-destructive text-sm",children:r.type})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(i,{htmlFor:"party_id",children:"Party"}),e.jsx(P,{route:"/api/parties/select",params:f(),value:y,onChange:t=>{N(t),s("party_id",(t==null?void 0:t.id)||"")},placeholder:"Select a party",renderOption:t=>t.name,renderSelected:t=>t.name}),r.party_id&&e.jsx("p",{className:"text-destructive text-sm",children:r.party_id})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(i,{htmlFor:"container_no",children:a.type==="container"?"Container Number":"Reference Number"}),e.jsx(n,{id:"container_no",value:a.container_no,onChange:t=>s("container_no",t.target.value),placeholder:a.type==="container"?"Enter container number":"Enter reference number"}),r.container_no&&e.jsx("p",{className:"text-destructive text-sm",children:r.container_no})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(i,{htmlFor:"movement_date",children:a.type==="container"?"Movement Date":"Delivery Date"}),e.jsx(n,{id:"movement_date",type:"date",value:a.movement_date,onChange:t=>s("movement_date",t.target.value)}),r.movement_date&&e.jsx("p",{className:"text-destructive text-sm",children:r.movement_date})]}),a.type==="container"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(i,{htmlFor:"bl_no",children:"BL Number"}),e.jsx(n,{id:"bl_no",value:a.bl_no,onChange:t=>s("bl_no",t.target.value),placeholder:"Enter BL number"}),r.bl_no&&e.jsx("p",{className:"text-destructive text-sm",children:r.bl_no})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(i,{htmlFor:"bl_date",children:"BL Date"}),e.jsx(n,{id:"bl_date",type:"date",value:a.bl_date,onChange:t=>s("bl_date",t.target.value)}),r.bl_date&&e.jsx("p",{className:"text-destructive text-sm",children:r.bl_date})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(i,{htmlFor:"be_no",children:"BE Number"}),e.jsx(n,{id:"be_no",value:a.be_no,onChange:t=>s("be_no",t.target.value),placeholder:"Enter BE number"}),r.be_no&&e.jsx("p",{className:"text-destructive text-sm",children:r.be_no})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(i,{htmlFor:"be_date",children:"BE Date"}),e.jsx(n,{id:"be_date",type:"date",value:a.be_date,onChange:t=>s("be_date",t.target.value)}),r.be_date&&e.jsx("p",{className:"text-destructive text-sm",children:r.be_date})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(i,{htmlFor:"bl_weight",children:"BL Weight (kg)"}),e.jsx(n,{id:"bl_weight",type:"number",step:"0.01",value:a.bl_weight,onChange:t=>s("bl_weight",t.target.value),placeholder:"Enter BL weight"}),r.bl_weight&&e.jsx("p",{className:"text-destructive text-sm",children:r.bl_weight})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(i,{htmlFor:"weigh_bridge_weight",children:a.type==="container"?"Weigh Bridge Weight (kg)":"Total Weight (kg)"}),e.jsx(n,{id:"weigh_bridge_weight",type:"number",step:"0.01",value:a.weigh_bridge_weight,onChange:t=>s("weigh_bridge_weight",t.target.value),placeholder:a.type==="container"?"Enter weigh bridge weight":"Enter total weight"}),r.weigh_bridge_weight&&e.jsx("p",{className:"text-destructive text-sm",children:r.weigh_bridge_weight})]})]}),e.jsx(S,{children:e.jsx(F,{type:"submit",disabled:u,children:"Create Import"})})]})}export{z as default};
