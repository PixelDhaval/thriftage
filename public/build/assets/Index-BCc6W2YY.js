import{K as E,r,j as e,L as M,a as T,S as O}from"./app-uSUjqTQn.js";import{D as k}from"./delete-confirmation-dialog-CZZBGNIO.js";import{B as L,t as g}from"./index-DpybBKEl.js";import{D as A}from"./data-table-RL4gwhaw.js";import{D as x,e as B,a as h,b as u,c as f,d as y}from"./dialog-DYfVLIkn.js";import{A as F}from"./app-layout-Blrr1DP5.js";import $ from"./CreateImportForm-BRncoC47.js";import w from"./EditImportForm-8IVnfH1e.js";import{P}from"./plus-BpUIVsYb.js";import{f as s}from"./format-CiT9Q78D.js";import"./input-CrjKc2qP.js";import"./select-ColQXi4_.js";import"./floating-ui.dom-C5vApqfE.js";import"./index-B-8gcRhY.js";import"./check-BEFGZPj2.js";import"./chevrons-up-down-Beo5w5U9.js";import"./chevron-left-C7kKyXdo.js";import"./chevron-right-DY9Lal5L.js";import"./index-DotmkW1c.js";import"./label-CD_x2wtn.js";import"./progress-BfUie5Ot.js";import"./app-logo-icon-KU6A-tEr.js";import"./index-D7sdnARe.js";import"./CreateGradedBagPoolForm-C1gyOPcS.js";import"./async-select-YA0HXz5o.js";import"./printGradedBarcodes-DYoIjB7M.js";import"./printer-BrsyoSh2.js";const K=[{title:"Imports Management",href:"/imports"}];function ue({imports:R}){const n=E().props.auth,l=(n==null?void 0:n.permissions)||[],[j,c]=r.useState(!1),[b,m]=r.useState(!1),[D,o]=r.useState(!1),[p,W]=r.useState(null),[a,d]=r.useState(null),I=t=>{d(t),o(!0)},_=async()=>{var t,i;if(a)try{await T.delete(`/imports/${a.id}`,{headers:{"X-CSRF-TOKEN":((t=document.querySelector('meta[name="csrf-token"]'))==null?void 0:t.getAttribute("content"))||"",Accept:"application/json"}}),g.success(`Import ${a.container_no} deleted successfully.`),(i=window.refreshDataTable)==null||i.call(window)}catch(v){console.error("Error deleting import:",v),g.error("Failed to delete import. Please try again later.")}o(!1),d(null)},N=t=>{O.get(`/imports/${t.id}`)},C=[{label:"Party",key:"party.name"},{label:"Container No",key:"container_no"},{label:"BL No",key:"bl_no"},{label:"BE No",key:"be_no"},{label:"Type",key:"type"}],S=[{id:"party",header:"Party",enableSorting:!0,cell:({row:t})=>{var i;return e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{children:((i=t.original.party)==null?void 0:i.name)||"-"})})}},{id:"container_no",header:"Container No",enableSorting:!0,cell:({row:t})=>e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{children:t.original.container_no||"-"})})},{id:"movement_date",header:"Movement Date",enableSorting:!0,cell:({row:t})=>e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{children:t.original.movement_date?s(t.original.movement_date,"dd/MM/yyyy"):"-"})})},{id:"bl_details",header:"BL Details",enableSorting:!1,cell:({row:t})=>e.jsx("div",{className:"flex flex-col gap-1",children:t.original.type==="container"?e.jsxs(e.Fragment,{children:[e.jsxs("span",{children:["No: ",t.original.bl_no||"-"]}),e.jsxs("span",{children:["Date: ",t.original.bl_date?s(t.original.bl_date,"dd/MM/yyyy"):"-"]})]}):e.jsx("span",{className:"text-muted-foreground",children:"Local Delivery"})})},{id:"be_details",header:"BE Details",enableSorting:!1,cell:({row:t})=>e.jsx("div",{className:"flex flex-col gap-1",children:t.original.type==="container"?e.jsxs(e.Fragment,{children:[e.jsxs("span",{children:["No: ",t.original.be_no||"-"]}),e.jsxs("span",{children:["Date: ",t.original.be_date?s(t.original.be_date,"dd/MM/yyyy"):"-"]})]}):e.jsx("span",{className:"text-muted-foreground",children:"Local Delivery"})})},{id:"weights",header:"Weights",enableSorting:!1,cell:({row:t})=>e.jsxs("div",{className:"flex flex-col gap-1",children:[t.original.type==="container"&&e.jsxs("span",{children:["BL: ",t.original.bl_weight?`${t.original.bl_weight} kg`:"-"]}),e.jsxs("span",{children:[t.original.type==="container"?"WB:":"Total:"," ",t.original.weigh_bridge_weight?`${t.original.weigh_bridge_weight} kg`:"-"]})]})},{id:"type",header:"Type",enableSorting:!0,cell:({row:t})=>e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${t.original.type==="container"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:t.original.type==="container"?"Via Container":"Local Delivery"})})},{id:"created_at",header:"Created At",enableSorting:!0,cell:({row:t})=>e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{children:s(t.original.created_at,"dd/MM/yyyy")})})}];return e.jsxs(F,{breadcrumbs:K,children:[e.jsx(M,{title:"Imports Management"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4",children:[e.jsxs("div",{className:"mb-4 flex justify-between",children:[e.jsx("h1",{className:"text-2xl mt-4 font-semibold",children:"Imports Management"}),l.includes("imports-update")&&e.jsxs(x,{open:j,onOpenChange:c,children:[e.jsx(B,{asChild:!0,children:e.jsxs(L,{children:[e.jsx(P,{className:"mr-2 h-4 w-4"}),"Add Import"]})}),e.jsxs(h,{children:[e.jsxs(u,{children:[e.jsx(f,{children:"Create New Import"}),e.jsx(y,{children:"Add a new import to the system."})]}),e.jsx($,{onSuccess:()=>{var t;c(!1),(t=window.refreshDataTable)==null||t.call(window)}})]})]})]}),e.jsx(A,{filterableColumns:C,route:"/api/imports",columns:S,pageSize:20,...l.includes("imports-update")&&{onEdit:N},...l.includes("imports-update")&&{onDelete:I},params:{}}),e.jsx(x,{open:b,onOpenChange:m,children:e.jsxs(h,{children:[e.jsxs(u,{children:[e.jsx(f,{children:"Edit Import"}),e.jsx(y,{children:"Update import details."})]}),p&&e.jsx(w,{import:p,onSuccess:()=>{var t;m(!1),(t=window.refreshDataTable)==null||t.call(window)}})]})}),e.jsx(k,{isOpen:D,onClose:()=>{o(!1),d(null)},onConfirm:_,title:"Delete Import",description:`Are you sure you want to delete ${a==null?void 0:a.container_no}? This action cannot be undone.`})]})]})}export{ue as default};
