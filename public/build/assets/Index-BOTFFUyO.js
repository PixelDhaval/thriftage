import{K as E,r as s,j as e,L as O,a as k}from"./app-uSUjqTQn.js";import{D as A}from"./delete-confirmation-dialog-CZZBGNIO.js";import{B as w,t as m}from"./index-DpybBKEl.js";import{D as _}from"./data-table-RL4gwhaw.js";import{D as h,e as F,a as x,b as g,c as u,d as y}from"./dialog-DYfVLIkn.js";import{A as I}from"./app-layout-Blrr1DP5.js";import L from"./CreatePartyForm-BniY0WH0.js";import B from"./EditPartyForm-DyWRh3xV.js";import{P as M}from"./plus-BpUIVsYb.js";import"./input-CrjKc2qP.js";import"./select-ColQXi4_.js";import"./floating-ui.dom-C5vApqfE.js";import"./index-B-8gcRhY.js";import"./check-BEFGZPj2.js";import"./chevrons-up-down-Beo5w5U9.js";import"./chevron-left-C7kKyXdo.js";import"./chevron-right-DY9Lal5L.js";import"./index-DotmkW1c.js";import"./label-CD_x2wtn.js";import"./progress-BfUie5Ot.js";import"./app-logo-icon-KU6A-tEr.js";import"./index-D7sdnARe.js";import"./CreateGradedBagPoolForm-C1gyOPcS.js";import"./async-select-YA0HXz5o.js";import"./printGradedBarcodes-DYoIjB7M.js";import"./printer-BrsyoSh2.js";const $=[{title:"Parties Management",href:"/parties"}];function he({parties:z}){const r=E().props.auth,i=(r==null?void 0:r.permissions)||[],[f,c]=s.useState(!1),[j,l]=s.useState(!1),[D,n]=s.useState(!1),[d,b]=s.useState(null),[t,o]=s.useState(null),P=a=>{o(a),n(!0)},S=async()=>{var a,p;if(t)try{await k.delete(`/parties/${t.id}`,{headers:{"X-CSRF-TOKEN":((a=document.querySelector('meta[name="csrf-token"]'))==null?void 0:a.getAttribute("content"))||"",Accept:"application/json"}}),m.success(`Party ${t.name} deleted successfully.`),(p=window.refreshDataTable)==null||p.call(window)}catch(T){console.error("Error deleting party:",T),m.error("Failed to delete party. Please try again later.")}n(!1),o(null)},C=a=>{b(a),l(!0)},N=[{label:"Name",key:"name"},{label:"Type",key:"type"},{label:"City",key:"city"},{label:"State",key:"state"},{label:"Phone",key:"phone"},{label:"Email",key:"email"},{label:"GST",key:"gst"}],v=[{id:"name",header:"Name",enableSorting:!0,cell:({row:a})=>e.jsx("div",{className:"flex parties-center gap-2",children:e.jsx("span",{children:a.original.name})})},{id:"type",header:"Type",enableSorting:!0,cell:({row:a})=>e.jsx("div",{className:"flex parties-center gap-2",children:e.jsx("span",{children:a.original.type||"-"})})},{id:"address",header:"Address",enableSorting:!1,cell:({row:a})=>e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{children:a.original.address_line_1||""}),a.original.address_line_2&&e.jsx("span",{children:a.original.address_line_2}),e.jsx("span",{children:[a.original.city,a.original.state,a.original.zip].filter(Boolean).join(", ")}),e.jsx("span",{children:a.original.country||""})]})},{id:"contact",header:"Contact",enableSorting:!1,cell:({row:a})=>e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{children:a.original.phone||"-"}),e.jsx("span",{children:a.original.email||"-"})]})},{id:"gst",header:"GST",enableSorting:!0,cell:({row:a})=>e.jsx("div",{className:"flex parties-center gap-2",children:e.jsx("span",{children:a.original.gst||"-"})})},{id:"created_at",header:"Created At",enableSorting:!0,cell:({row:a})=>e.jsx("div",{className:"flex parties-center gap-2",children:e.jsx("span",{children:new Date(a.original.created_at).toLocaleDateString()})})}];return e.jsxs(I,{breadcrumbs:$,children:[e.jsx(O,{title:"Parties Management"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4",children:[e.jsxs("div",{className:"mb-4 flex justify-between",children:[e.jsx("h1",{className:"text-2xl mt-4 font-semibold",children:"Parties Management"}),i.includes("parties-update")&&e.jsxs(h,{open:f,onOpenChange:c,children:[e.jsx(F,{asChild:!0,children:e.jsxs(w,{children:[e.jsx(M,{className:"mr-2 h-4 w-4"}),"Add Party"]})}),e.jsxs(x,{className:"max-h-[90vh] overflow-y-auto",children:[e.jsxs(g,{children:[e.jsx(u,{children:"Create New Party"}),e.jsx(y,{children:"Add a new party to the system."})]}),e.jsx(L,{onSuccess:()=>{var a;c(!1),(a=window.refreshDataTable)==null||a.call(window)}})]})]})]}),e.jsx(_,{filterableColumns:N,route:"/api/parties",columns:v,pageSize:20,...i.includes("parties-update")&&{onEdit:C},...i.includes("parties-update")&&{onDelete:P},params:{}}),e.jsx(h,{open:j,onOpenChange:l,children:e.jsxs(x,{className:"max-h-[90vh] overflow-y-auto",children:[e.jsxs(g,{children:[e.jsx(u,{children:"Edit Party"}),e.jsx(y,{children:"Update party details."})]}),d&&e.jsx(B,{party:d,onSuccess:()=>{var a;l(!1),(a=window.refreshDataTable)==null||a.call(window)}})]})}),e.jsx(A,{isOpen:D,onClose:()=>{n(!1),o(null)},onConfirm:S,title:"Delete Party",description:`Are you sure you want to delete ${t==null?void 0:t.name}? This action cannot be undone.`})]})]})}export{he as default};
