import{r as f,m as b,j as e,a as y}from"./app-DZIhMt8j.js";import{B as C,t as p}from"./index-CG21suBH.js";import{C as E}from"./checkbox-Diw84W58.js";import{f as k}from"./dialog-DTFu0e2V.js";import{I as m}from"./input-D_EtKzRg.js";import{L as o}from"./label-gKVdXsPW.js";import"./index-CNZzqPiH.js";import"./index-VCFY5RQ9.js";import"./check-DofblWpS.js";import"./index-BgEnKjmm.js";function A({user:a,roles:j,permissions:F,onSuccess:c}){const[g,x]=f.useState(!1),{data:r,setData:i,errors:t,setError:v,clearErrors:w}=b({name:a.name,email:a.email,password:"",password_confirmation:"",roles:a.roles.map(s=>s.id),permissions:a.permissions.map(s=>s.id)});f.useEffect(()=>{i({name:a.name,email:a.email,password:"",password_confirmation:"",roles:a.roles.map(s=>s.id),permissions:a.permissions.map(s=>s.id)})},[a]);const N=async s=>{var d,n;s.preventDefault(),w(),x(!0);try{const l=await y.put(`/users/${a.id}`,r,{headers:{"X-CSRF-TOKEN":((d=document.querySelector('meta[name="csrf-token"]'))==null?void 0:d.getAttribute("content"))||"","Content-Type":"application/json",Accept:"application/json"}});p.success("User updated successfully!"),l.data.user,c==null||c()}catch(l){if(console.error("Error updating user:",l),((n=l.response)==null?void 0:n.status)===422){const h=l.response.data.errors;Object.keys(h).forEach(u=>{v(u,h[u][0])}),p.error("Please check the form for errors.")}else p.error("Failed to update user. Please try again later.")}finally{x(!1)}};return e.jsxs("form",{onSubmit:N,className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(o,{htmlFor:"name",children:"Name"}),e.jsx(m,{id:"name",value:r.name,onChange:s=>i("name",s.target.value),required:!0}),t.name&&e.jsx("p",{className:"text-destructive text-sm",children:t.name})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(o,{htmlFor:"email",children:"Email"}),e.jsx(m,{id:"email",type:"email",value:r.email,onChange:s=>i("email",s.target.value),required:!0}),t.email&&e.jsx("p",{className:"text-destructive text-sm",children:t.email})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(o,{htmlFor:"password",children:"Password"}),e.jsx(m,{id:"password",type:"password",value:r.password,onChange:s=>i("password",s.target.value),placeholder:"Leave blank to keep current password"}),t.password&&e.jsx("p",{className:"text-destructive text-sm",children:t.password})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(o,{htmlFor:"password_confirmation",children:"Confirm Password"}),e.jsx(m,{id:"password_confirmation",type:"password",value:r.password_confirmation,onChange:s=>i("password_confirmation",s.target.value),placeholder:"Leave blank to keep current password"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(o,{children:"Roles"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:j.map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(E,{id:`role-${s.id}`,checked:r.roles.includes(s.id),onCheckedChange:d=>{d?i("roles",[...r.roles,s.id]):i("roles",r.roles.filter(n=>n!==s.id))}}),e.jsx(o,{htmlFor:`role-${s.id}`,className:"text-sm font-normal",children:s.name})]},s.id))}),t.roles&&e.jsx("p",{className:"text-destructive text-sm",children:t.roles})]})]}),e.jsx(k,{children:e.jsx(C,{type:"submit",disabled:g,children:"Update User"})})]})}export{A as default};
