import{r as h,m as b,j as e,a as E}from"./app-CMik14HJ.js";import{B as _,t as p}from"./index-CakOBAWj.js";import{f as C}from"./dialog-HoTurtI_.js";import{I as f}from"./input-ALDPQvLe.js";import{L as l}from"./label-DRAuss-2.js";import{C as F}from"./checkbox-CnUlKECC.js";import"./index-Cmy6J4pR.js";import"./index-BBZuHhmn.js";import"./index-D1KQpMN7.js";import"./check-DU87odb6.js";function L({role:a,permissions:j,onSuccess:d}){const[g,c]=h.useState(!1),{data:r,setData:i,errors:t,setError:y,clearErrors:v}=b({name:a.name,display_name:a.display_name,permissions:a.permissions.map(s=>s.id)});h.useEffect(()=>{i({name:a.name,display_name:a.display_name,permissions:a.permissions.map(s=>s.id)})},[a]);const N=async s=>{var m,o;s.preventDefault(),v(),c(!0);try{const n=await E.put(`/roles/${a.id}`,r,{headers:{"X-CSRF-TOKEN":((m=document.querySelector('meta[name="csrf-token"]'))==null?void 0:m.getAttribute("content"))||"","Content-Type":"application/json",Accept:"application/json"}});p.success("Role updated successfully!"),n.data.role,d==null||d()}catch(n){if(console.error("Error updating role:",n),((o=n.response)==null?void 0:o.status)===422){const u=n.response.data.errors;Object.keys(u).forEach(x=>{y(x,u[x][0])}),p.error("Please check the form for errors.")}else p.error("Failed to update role. Please try again later.")}finally{c(!1)}};return e.jsxs("form",{onSubmit:N,className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"name",children:"Name"}),e.jsx(f,{id:"name",value:r.name,onChange:s=>i("name",s.target.value),required:!0,placeholder:"role-name"}),t.name&&e.jsx("p",{className:"text-destructive text-sm",children:t.name})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"display_name",children:"Display Name"}),e.jsx(f,{id:"display_name",value:r.display_name,onChange:s=>i("display_name",s.target.value),required:!0,placeholder:"Role Name"}),t.display_name&&e.jsx("p",{className:"text-destructive text-sm",children:t.display_name})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{children:"Permissions"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:j.map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(F,{id:`permission-${s.id}`,checked:r.permissions.includes(s.id),onCheckedChange:m=>{m?i("permissions",[...r.permissions,s.id]):i("permissions",r.permissions.filter(o=>o!==s.id))}}),e.jsx(l,{htmlFor:`permission-${s.id}`,className:"text-sm font-normal",children:s.name})]},s.id))}),t.permissions&&e.jsx("p",{className:"text-destructive text-sm",children:t.permissions})]})]}),e.jsx(C,{children:e.jsx(_,{type:"submit",disabled:g,children:"Update Role"})})]})}export{L as default};
