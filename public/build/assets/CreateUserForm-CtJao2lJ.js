import{r as h,m as C,j as e,a as y}from"./app-2f7IQbBX.js";import{B as b,t as c}from"./index-RxcBBsgh.js";import{f as E}from"./dialog-DdTGJnuh.js";import{I as n}from"./input-BNb4nAbV.js";import{L as i}from"./label-AF-c3Qo_.js";import{C as F}from"./checkbox-CwqNRCit.js";import"./index-BDLkvWYf.js";import"./index-BUyi983T.js";import"./check-Br4RgOZi.js";function $({roles:f,permissions:k,onSuccess:m}){const[g,p]=h.useState(!1),[q,S]=h.useState(null),{data:r,setData:t,reset:j,errors:a,setError:v,clearErrors:w}=C({name:"",email:"",password:"",password_confirmation:"",roles:[],permissions:[]}),N=async s=>{var o,l;s.preventDefault(),w(),p(!0);try{const d=await y.post("/users",r,{headers:{"X-CSRF-TOKEN":((o=document.querySelector('meta[name="csrf-token"]'))==null?void 0:o.getAttribute("content"))||""}});c.success("User created successfully!"),j(),m==null||m()}catch(d){if(console.error("Error creating user:",d),((l=d.response)==null?void 0:l.status)===422){const u=d.response.data.errors;Object.keys(u).forEach(x=>{v(x,u[x][0])}),c.error("Please check the form for errors.")}else c.error("Failed to create user. Please try again later.")}finally{p(!1)}};return e.jsxs("form",{onSubmit:N,className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(i,{htmlFor:"name",children:"Name"}),e.jsx(n,{id:"name",value:r.name,onChange:s=>t("name",s.target.value),required:!0}),a.name&&e.jsx("p",{className:"text-destructive text-sm",children:a.name})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(i,{htmlFor:"email",children:"Email"}),e.jsx(n,{id:"email",type:"email",value:r.email,onChange:s=>t("email",s.target.value),required:!0}),a.email&&e.jsx("p",{className:"text-destructive text-sm",children:a.email})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(i,{htmlFor:"password",children:"Password"}),e.jsx(n,{id:"password",type:"password",value:r.password,onChange:s=>t("password",s.target.value),required:!0}),a.password&&e.jsx("p",{className:"text-destructive text-sm",children:a.password})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(i,{htmlFor:"password_confirmation",children:"Confirm Password"}),e.jsx(n,{id:"password_confirmation",type:"password",value:r.password_confirmation,onChange:s=>t("password_confirmation",s.target.value),required:!0})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(i,{children:"Roles"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:f.map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(F,{id:`role-${s.id}`,checked:r.roles.includes(s.id),onCheckedChange:o=>{o?t("roles",[...r.roles,s.id]):t("roles",r.roles.filter(l=>l!==s.id))}}),e.jsx(i,{htmlFor:`role-${s.id}`,className:"text-sm font-normal",children:s.name})]},s.id))}),a.roles&&e.jsx("p",{className:"text-destructive text-sm",children:a.roles})]})]}),e.jsx(E,{children:e.jsx(b,{type:"submit",disabled:g,children:"Create User"})})]})}export{$ as default};
