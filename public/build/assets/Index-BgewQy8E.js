import{K as C,r as l,j as e,L as E,S as N}from"./app-CBgNfxV6.js";import{D as v}from"./delete-confirmation-dialog-BJZ4sBDB.js";import{B as O}from"./badge-BnGNSE-q.js";import{B as T,t as x}from"./index-CxkpNBdp.js";import{D as A}from"./data-table-CQechFEf.js";import{D as h,a as f,b as j,c as g,d as D}from"./dialog-BcVaU9Qh.js";import{A as k}from"./app-layout-DR9tcCOi.js";import B from"./CreateUserForm-DR52TVX7.js";import P from"./EditUserForm-D-QKJ1mv.js";import{P as F}from"./plus-D7GxHvF9.js";import"./input-3IsToTN2.js";import"./select-C2ax7mEg.js";import"./floating-ui.dom-C5vApqfE.js";import"./index-uXSY9LXb.js";import"./check-Dj-469CK.js";import"./chevrons-up-down-DfHQhOV1.js";import"./chevron-left-6Nt7LTEn.js";import"./chevron-right-DR-G9Dqz.js";import"./index-CBcOgFbC.js";import"./label-DNWKkJcz.js";import"./progress-CFwJbafQ.js";import"./app-logo-icon-xi0eLu_D.js";import"./index-uOd2QEXc.js";import"./CreateGradedBagPoolForm-B8eUe2q9.js";import"./async-select-D5o3p28K.js";import"./printGradedBarcodes-u0ulMplK.js";import"./printer-C-JYDqHW.js";import"./checkbox-CH_fKCPY.js";const I=[{title:"Users Management",href:"/users"}],L=[{id:"name",header:"Name",enableSorting:!0,cell:({row:r})=>e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{children:r.original.name})})},{id:"email",header:"Email",enableSorting:!0,cell:({row:r})=>e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{children:r.original.email})})},{id:"roles",header:"Roles",cell:({row:r})=>e.jsx("div",{className:"flex flex-wrap gap-1",children:r.original.roles.map(t=>e.jsx(O,{variant:"outline",children:t.name},t.id))})}],M=[{label:"Name",key:"name"},{label:"Email",key:"email"},{label:"Role",key:"roles.name"}];function ue({roles:r,permissions:t}){const i=C().props.auth,d=(i==null?void 0:i.permissions)||[],o=d.includes("users-update");d.includes("users-delete");const[a,n]=l.useState(null),[b,m]=l.useState(!1),[w,c]=l.useState(!1),[p,u]=l.useState(null),U=s=>{u(s),c(!0)},S=s=>{n(s)},y=()=>{a&&N.delete(`/users/${a.id}`,{onSuccess:()=>{var s;x.success("User deleted successfully!"),n(null),(s=window.refreshDataTable)==null||s.call(window)},onError:()=>{x.error("Failed to delete user. Please try again.")}})};return e.jsxs(k,{breadcrumbs:I,children:[e.jsx(E,{title:"Users Management"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4",children:[o&&e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Users Management"}),e.jsxs(T,{onClick:()=>m(!0),children:[e.jsx(F,{className:"mr-2 h-4 w-4"}),"Add User"]})]}),e.jsx(A,{filterableColumns:M,route:"/api/users",columns:L,pageSize:10,...o&&{onEdit:U},...o&&{onDelete:S},params:{}})]}),e.jsx(h,{open:b,onOpenChange:m,children:e.jsxs(f,{className:"max-h-[90vh] overflow-y-auto",children:[e.jsxs(j,{children:[e.jsx(g,{children:"Create New User"}),e.jsx(D,{children:"Add a new user to the system."})]}),e.jsx(B,{roles:r,permissions:t,onSuccess:()=>{var s;m(!1),(s=window.refreshDataTable)==null||s.call(window)}})]})}),e.jsx(h,{open:w,onOpenChange:c,children:e.jsxs(f,{className:"max-h-[90vh] overflow-y-auto",children:[e.jsxs(j,{children:[e.jsx(g,{children:"Edit User"}),e.jsx(D,{children:"Update user details, roles, and permissions."})]}),p&&e.jsx(P,{user:p,roles:r,permissions:t,onSuccess:()=>{var s;c(!1),u(null),(s=window.refreshDataTable)==null||s.call(window)}})]})}),e.jsx(v,{isOpen:!!a,onClose:()=>n(null),onConfirm:y,title:"Delete User",description:`Are you sure you want to delete ${a==null?void 0:a.name}? This action cannot be undone.`})]})}export{ue as default};
