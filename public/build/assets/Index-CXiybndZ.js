import{K as v,r as g,j as e,L as C,a as h}from"./app-ByYlsqso.js";import{A as _,S as A,B}from"./app-layout-CJRMCBna.js";import{c as M,B as n,t as o}from"./index-BCUn2pAr.js";import{D as O}from"./data-table-4qJ_Q_Xk.js";import{f as u}from"./format-CiT9Q78D.js";import"./dialog-DW0IMjsb.js";import"./index-CMIcp8u6.js";import"./index-DXBWSKnI.js";import"./input-B5apdutg.js";import"./label-D4kYqDni.js";import"./progress-C5CCvUab.js";import"./app-logo-icon-CyJij1Tq.js";import"./select-B8sg3PlV.js";import"./floating-ui.dom-C5vApqfE.js";import"./check-DTWqeJbN.js";import"./index-DJdMjmy0.js";import"./chevrons-up-down-Bs9qXztR.js";import"./chevron-right-DbNAn7bC.js";import"./CreateGradedBagPoolForm-C2j5RNjU.js";import"./async-select-CRfvG8yt.js";import"./printGradedBarcodes-NhWhYMVq.js";import"./printer-DjVQZ1x9.js";import"./chevron-left-D0Kt2IEv.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],b=M("CircleCheckBig",U),w=[{title:"Bags Opening",href:"/bags-opening"}];function te(){const d=v().props.auth,c=(d==null?void 0:d.permissions)||[],[i,l]=g.useState(null),[f,x]=g.useState(!1),[r,j]=g.useState({status:"unopened",sort_column:"updated_at",sort_direction:"desc"}),y=async a=>{var t,s;l(a.id.toString());try{await h.put(`/import-bags/${a.id}`,{status:"opened"},{headers:{"X-CSRF-TOKEN":((t=document.querySelector('meta[name="csrf-token"]'))==null?void 0:t.getAttribute("content"))||"","Content-Type":"application/json",Accept:"application/json"}}),o.success(`Bag ${a.barcode} marked as opened successfully.`),(s=window.refreshDataTable)==null||s.call(window)}catch(m){console.error("Error updating import bag status:",m),o.error("Failed to mark bag as opened. Please try again later.")}finally{l(null)}},N=async a=>{var t,s;l(a.id.toString());try{await h.put(`/import-bags/${a.id}`,{status:"unopened"},{headers:{"X-CSRF-TOKEN":((t=document.querySelector('meta[name="csrf-token"]'))==null?void 0:t.getAttribute("content"))||"","Content-Type":"application/json",Accept:"application/json"}}),o.success(`Bag ${a.barcode} marked as unopened successfully.`),(s=window.refreshDataTable)==null||s.call(window)}catch(m){console.error("Error updating import bag status:",m),o.error("Failed to mark bag as unopened. Please try again later.")}finally{l(null)}},p=a=>{j(t=>({...t,status:a==="all"?"":a}))},S=[{label:"Barcode",key:"barcode"},{label:"Party",key:"party.name"},{label:"Weight",key:"weight.weight"},{label:"Container/Reference",key:"import.container_no"},{label:"Created At",key:"created_at"}],k=[{id:"barcode",header:"Barcode",enableSorting:!0,cell:({row:a})=>e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:"font-mono text-sm font-medium",children:a.original.barcode})})},{id:"party",header:"Party",enableSorting:!0,cell:({row:a})=>{var t;return e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{children:((t=a.original.party)==null?void 0:t.name)||"-"})})}},{id:"weight",header:"Weight",enableSorting:!0,cell:({row:a})=>{var t;return e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("span",{children:[((t=a.original.weight)==null?void 0:t.weight)||"-"," kg"]})})}},{id:"import_details",header:"Import Details",enableSorting:!1,cell:({row:a})=>{var t,s;return e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-medium",children:((t=a.original.import)==null?void 0:t.container_no)||"-"}),e.jsx("span",{className:"text-muted-foreground text-xs",children:((s=a.original.import)==null?void 0:s.type)==="container"?"Container":"Local"})]})}},{id:"movement_date",header:"Movement Date",enableSorting:!0,cell:({row:a})=>{var t;return e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{children:(t=a.original.import)!=null&&t.movement_date?u(a.original.import.movement_date,"dd/MM/yyyy"):"-"})})}},{id:"created_at",header:"Created At",enableSorting:!0,cell:({row:a})=>e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{children:u(a.original.created_at,"dd/MM/yyyy HH:mm")})})},{id:"updated_at",header:"Updated At",enableSorting:!0,cell:({row:a})=>e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{children:u(a.original.updated_at,"dd/MM/yyyy HH:mm")})})},{id:"status",header:"Status",enableSorting:!1,cell:({row:a})=>e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:`rounded-full px-2 py-1 text-xs ${a.original.status==="opened"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:a.original.status})})},...c.includes("bags-opening-update")?[{id:"actions",header:"Actions",enableSorting:!1,cell:({row:a})=>e.jsx("div",{className:"flex items-center gap-2",children:c.includes("import-bags-update")&&e.jsx(e.Fragment,{children:a.original.status==="unopened"?e.jsxs(n,{variant:"outline",size:"sm",onClick:()=>y(a.original),disabled:i===a.original.id.toString(),className:"h-8 border-green-200 bg-green-50 px-3 text-green-700 hover:bg-green-100",title:"Mark this bag as opened",children:[e.jsx(b,{className:"mr-1 h-3 w-3"}),i===a.original.id.toString()?"Updating...":"Mark as Opened"]}):e.jsxs(n,{variant:"outline",size:"sm",onClick:()=>N(a.original),disabled:i===a.original.id.toString(),className:"h-8 border-red-200 bg-red-50 px-3 text-red-700 hover:bg-red-100",title:"Mark this bag as unopened",children:[e.jsx(b,{className:"mr-1 h-3 w-3"}),i===a.original.id.toString()?"Updating...":"Mark as Unopened"]})})})}]:[]];return e.jsxs(_,{breadcrumbs:w,children:[e.jsx(C,{title:"Bags Opening"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4",children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Bags Opening"}),e.jsxs("p",{className:"text-muted-foreground",children:["Press ",e.jsx("kbd",{className:"bg-muted rounded px-1 py-0.5 text-xs",children:"Ctrl+I"})," to open barcode scanner."]})]}),c.includes("bags-opening-update")&&e.jsxs(n,{onClick:()=>x(!0),className:"gap-2",children:[e.jsx(A,{className:"h-4 w-4"}),"Open Scanner"]})]}),e.jsxs("div",{className:"mb-4 flex gap-2",children:[e.jsx(n,{variant:r.status===""?"default":"outline",size:"sm",onClick:()=>p("all"),className:"h-9",children:"All Bags"}),e.jsx(n,{variant:r.status==="unopened"?"default":"outline",size:"sm",onClick:()=>p("unopened"),className:"h-9",children:"Unopened Bags"}),e.jsx(n,{variant:r.status==="opened"?"default":"outline",size:"sm",onClick:()=>p("opened"),className:"h-9",children:"Opened Bags"})]}),e.jsx(O,{filterableColumns:S,route:"/api/import-bags-with-barcodes",columns:k,pageSize:20,params:r},`status-${r.status}`),e.jsx(B,{isOpen:f,onClose:()=>x(!1)})]})]})}export{te as default};
