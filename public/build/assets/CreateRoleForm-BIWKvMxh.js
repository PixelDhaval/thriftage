import{r as N,m as b,j as e,a as C}from"./app-CDTBVDWO.js";import{B as E,t as d}from"./index-A2qBzo_b.js";import{f as F}from"./dialog-_Z8jwdbM.js";import{I as h}from"./input-D8UP1EuQ.js";import{L as n}from"./label-LhbJgM6z.js";import{C as _}from"./checkbox-DF5-a3JW.js";import"./index-DvgLuhnK.js";import"./index-wiqlczzX.js";import"./index-BcvJWT06.js";import"./check-DlVDLzEe.js";function O({permissions:u,onSuccess:m}){const[f,c]=N.useState(!1),{data:r,setData:t,errors:a,setError:j,reset:g,clearErrors:y}=b({name:"",display_name:"",permissions:[]}),v=async s=>{var i,o;s.preventDefault(),y(),c(!0);try{const l=await C.post("/roles",r,{headers:{"X-CSRF-TOKEN":((i=document.querySelector('meta[name="csrf-token"]'))==null?void 0:i.getAttribute("content"))||"","Content-Type":"application/json",Accept:"application/json"}});d.success("Role created successfully!"),g(),m==null||m()}catch(l){if(console.error("Error creating role:",l),((o=l.response)==null?void 0:o.status)===422){const p=l.response.data.errors;Object.keys(p).forEach(x=>{j(x,p[x][0])}),d.error("Please check the form for errors.")}else d.error("Failed to create role. Please try again later.")}finally{c(!1)}};return e.jsxs("form",{onSubmit:v,className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(n,{htmlFor:"name",children:"Name"}),e.jsx(h,{id:"name",value:r.name,onChange:s=>t("name",s.target.value),required:!0,placeholder:"role-name"}),a.name&&e.jsx("p",{className:"text-destructive text-sm",children:a.name})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(n,{htmlFor:"display_name",children:"Display Name"}),e.jsx(h,{id:"display_name",value:r.display_name,onChange:s=>t("display_name",s.target.value),required:!0,placeholder:"Role Name"}),a.display_name&&e.jsx("p",{className:"text-destructive text-sm",children:a.display_name})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(n,{children:"Permissions"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:u.map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(_,{id:`permission-${s.id}`,checked:r.permissions.includes(s.id),onCheckedChange:i=>{i?t("permissions",[...r.permissions,s.id]):t("permissions",r.permissions.filter(o=>o!==s.id))}}),e.jsx(n,{htmlFor:`permission-${s.id}`,className:"text-sm font-normal",children:s.name})]},s.id))}),a.permissions&&e.jsx("p",{className:"text-destructive text-sm",children:a.permissions})]})]}),e.jsx(F,{children:e.jsx(E,{type:"submit",disabled:f,children:"Create Role"})})]})}export{O as default};
